(function(){"use strict";var e={799:function(e,t,n){var a=n(9242),o=n(3396);function l(e,t){const n=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(n)}var u=n(89);const i={},s=(0,u.Z)(i,[["render",l]]);var r=s,c=n(678),d=n(4870),m=n(6265),p=n.n(m),v=n(2135),f=n(680);const g="token";function h(){return f.Z.get(g)}function w(e){return f.Z.set(g,e,{expires:1})}function _(){return f.Z.remove(g)}const y=p().create({baseURL:"https://tts.shanyexia.top",timeout:1e4});y.interceptors.request.use((e=>(h()&&(e.headers[g]=h()),e))),y.interceptors.response.use((e=>{const t=e.data;return 500===t.code?((0,v.g)(t.msg),Promise.reject(t.msg)):401===t.code?(De.push(`/login?redirect=${De.currentRoute.value.fullPath}`),(0,v.g)(t.msg),Promise.reject(t.msg)):t}));var b=y,W=n(65);const x=e=>((0,o.dD)("data-v-6e624994"),e=e(),(0,o.Cn)(),e),k={class:"tts-login"},V=x((()=>(0,o._)("h3",{class:"title"},"小米账号登录",-1))),U=x((()=>(0,o._)("div",{class:"logo"},[(0,o._)("img",{width:"48",src:"https://s02.mifile.cn/assets/static/image/logo-mi2.png",alt:"logo"}),(0,o._)("p",null,"让每个人都能享受科技的乐趣")],-1))),H=(0,o.Uk)(" 登录 ");var C={__name:"tts-login",setup(e){const t=(0,c.tv)(),n=(0,c.yj)(),a=(0,W.oR)(),l=(0,d.iH)(""),u=(0,d.iH)(""),i=(0,d.iH)(!1),s=e=>{i.value=!0,b({url:"/tts/login",method:"post",data:e}).then((e=>{200===e.code?(a.dispatch("setDevices"),f.Z.set("deviceId",e.data.deviceId),w(e.data.token),n.query.redirect?t.push(n.query.redirect):t.push("/layout")):201===e.code&&t.push("/no-device")})).finally((()=>{i.value=!1}))};return(e,t)=>{const n=(0,o.up)("van-field"),a=(0,o.up)("van-cell-group"),r=(0,o.up)("van-button"),c=(0,o.up)("van-form");return(0,o.wg)(),(0,o.iD)("div",k,[V,U,(0,o.Wm)(c,{onSubmit:s},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{inset:""},{default:(0,o.w5)((()=>[(0,o.Wm)(n,{modelValue:l.value,"onUpdate:modelValue":t[0]||(t[0]=e=>l.value=e),name:"username",label:"用户名",placeholder:"请输入用户名",rules:[{required:!0,message:"请输入用户名"}]},null,8,["modelValue"]),(0,o.Wm)(n,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),type:"password",name:"password",label:"密码",placeholder:"请输入密码",rules:[{required:!0,message:"请输入密码"}]},null,8,["modelValue"])])),_:1}),(0,o.Wm)(r,{round:"",block:"",type:"primary","native-type":"submit","loading-text":"登录中...",loading:i.value},{default:(0,o.w5)((()=>[H])),_:1},8,["loading"])])),_:1})])}}};const D=(0,u.Z)(C,[["__scopeId","data-v-6e624994"]]);var O=D;const S={class:"tts-no-device"},j=(0,o.Uk)("确定");var Z={__name:"tts-no-device",setup(e){const t=(0,c.tv)();function n(){t.push("/login")}return(e,t)=>{const a=(0,o.up)("van-button"),l=(0,o.up)("van-empty");return(0,o.wg)(),(0,o.iD)("div",S,[(0,o.Wm)(l,{image:"network",description:"没有设备在线，请检查网络是否正常"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{class:"bottom-button",type:"danger",round:"",onClick:n},{default:(0,o.w5)((()=>[j])),_:1})])),_:1})])}}};const q=(0,u.Z)(Z,[["__scopeId","data-v-79c4bcb8"]]);var I=q,z=n(7139),E=n(9733);const P=(0,o.Uk)(" [昵称]说：[留言内容…] "),T={class:"button-group"},Y=(0,o.Uk)("清空"),R=(0,o.Uk)("发送 ");var $={__name:"tts-praise",setup(e){const t=(0,c.yj)(),n=(0,d.iH)(6),a=(0,d.iH)(""),l=(0,d.iH)(""),u=(0,d.iH)(!1);function i(e){e>60?(0,v.g)({type:"warning",message:"开玩笑要有度哦"}):v.g.clear()}function s(){b({url:"/tts/getVolume?type=share&token="+t.query.token}).then((e=>{console.log(e);const t=JSON.parse(e.data.info);n.value=t.volume}))}function r(e){b({url:"/tts/setVolume?type=share&token="+t.query.token,method:"get",params:{volume:e}}).then((()=>{s()}))}function m(){l.value=""}function p(){u.value=!0,b({url:"/tts/say?type=share&token="+t.query.token,method:"post",data:{text:a.value+"说："+l.value}}).then((()=>{m(),(0,E.F)({message:"发送成功",position:"bottom"})})).finally((()=>{u.value=!1}))}return(0,o.bv)((()=>{s()})),(e,s)=>{const c=(0,o.up)("van-icon"),v=(0,o.up)("van-notice-bar"),f=(0,o.up)("van-field"),g=(0,o.up)("van-button"),h=(0,o.up)("van-col"),w=(0,o.up)("van-row"),_=(0,o.up)("van-cell-group"),y=(0,o.up)("van-slider"),b=(0,o.up)("van-form");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(v,{color:"#1989fa",background:"#ecf9ff","left-icon":"info-o"},{default:(0,o.w5)((()=>[(0,o.Uk)(" 发送成功后"+(0,z.zw)((0,d.SU)(t).query.name?(0,d.SU)(t).query.name:"分享者")+"的小爱音箱会以"+(0,z.zw)(n.value)+"%的音量播放 ",1),(0,o.Wm)(c,{name:"volume-o"}),P])),_:1}),(0,o.Wm)(b,{onSubmit:p},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{inset:"",title:"留言板"},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=e=>a.value=e),label:"昵称",placeholder:"请输入昵称",maxlength:"10",required:"",rules:[{required:!0,message:"请输入昵称"}]},null,8,["modelValue"]),(0,o.Wm)(f,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=e=>l.value=e),rows:"5",type:"textarea",maxlength:"50",placeholder:"说点好听的……","show-word-limit":"",rules:[{required:!0,message:"请输入留言内容"}]},null,8,["modelValue"]),(0,o._)("div",T,[(0,o.Wm)(w,{justify:"space-around"},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{span:"6"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"button",type:"warning",size:"small",round:"",onClick:m},{default:(0,o.w5)((()=>[Y])),_:1})])),_:1}),(0,o.Wm)(h,{span:"6"},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{class:"button","native-type":"submit",type:"primary",size:"small",round:"","loading-text":"发送",loading:u.value},{default:(0,o.w5)((()=>[R])),_:1},8,["loading"])])),_:1})])),_:1})])])),_:1}),(0,o.Wm)(_,{title:"音量："+n.value+"%",inset:"",style:{padding:"20px 32px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(y,{modelValue:n.value,"onUpdate:modelValue":[s[2]||(s[2]=e=>n.value=e),i],onChange:r},null,8,["modelValue"])])),_:1},8,["title"])])),_:1})],64)}}};const F=(0,u.Z)($,[["__scopeId","data-v-66516714"]]);var N=F;const J={class:"tts-layout"},M=(0,o.Uk)("首页"),B=(0,o.Uk)("打卡"),L=(0,o.Uk)("消息"),A=(0,o.Uk)("我的");function G(e,t){const n=(0,o.up)("router-view"),a=(0,o.up)("van-tabbar-item"),l=(0,o.up)("van-tabbar");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o._)("div",J,[(0,o.Wm)(n)]),(0,o.Wm)(l,{route:!0,placeholder:!0},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{icon:"home-o",to:"/layout/index"},{default:(0,o.w5)((()=>[M])),_:1}),(0,o.Wm)(a,{icon:"calendar-o",to:"/layout/daka"},{default:(0,o.w5)((()=>[B])),_:1}),(0,o.Wm)(a,{icon:"chat-o",to:"/layout/xiaoxi"},{default:(0,o.w5)((()=>[L])),_:1}),(0,o.Wm)(a,{icon:"manager-o",to:"/layout/wode"},{default:(0,o.w5)((()=>[A])),_:1})])),_:1})],64)}const K={},Q=(0,u.Z)(K,[["render",G]]);var X=Q,ee={__name:"tts-toggle-device",setup(e){const t=(0,W.oR)(),n=(0,o.Fl)((()=>t.state.devices)),a=(0,d.iH)("");function l(e){console.log("切换指定设备",e),f.Z.set("deviceId",e)}return a.value=f.Z.get("deviceId"),(0,o.bv)((()=>{n.value.length||t.dispatch("setDevices")})),(e,t)=>{const u=(0,o.up)("van-dropdown-item"),i=(0,o.up)("van-dropdown-menu"),s=(0,o.up)("van-sticky");return(0,o.wg)(),(0,o.j4)(s,null,{default:(0,o.w5)((()=>[(0,o.Wm)(i,{"active-color":"#1989fa","z-index":"999"},{default:(0,o.w5)((()=>[(0,o.Wm)(u,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=e=>a.value=e),options:(0,d.SU)(n),onChange:l},null,8,["modelValue","options"])])),_:1})])),_:1})}}};const te=ee;var ne=te,ae={__name:"tts-index",setup(e){return(e,t)=>((0,o.wg)(),(0,o.j4)((0,d.SU)(ne)))}};const oe=ae;var le=oe,ue=n(6431),ie={__name:"tts-wode",setup(e){const t=(0,c.tv)();function n(){ue.V.confirm({message:"确定退出登录吗？"}).then((()=>{_(),t.push("/login")})).catch((()=>{}))}return(e,t)=>{const a=(0,o.up)("van-cell"),l=(0,o.up)("van-cell-group");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(l,{inset:"",title:"个人信息"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{title:"单元格",value:"内容"}),(0,o.Wm)(a,{title:"单元格",value:"内容",label:"描述信息"})])),_:1}),(0,o.Wm)(l,{inset:"",title:"账号信息"},{default:(0,o.w5)((()=>[(0,o.Wm)(a,{title:"退出登录","title-class":"logout",clickable:"",onClick:n})])),_:1})],64)}}};const se=(0,u.Z)(ie,[["__scopeId","data-v-4701fa5f"]]);var re=se,ce={__name:"tts-daka",setup(e){const t=(0,d.iH)(new Date("2022-04-08")),n=(0,d.iH)(new Date);function a(e){return e.className="bgi",e}function l(e){console.log(e)}return(e,u)=>{const i=(0,o.up)("van-calendar"),s=(0,o.up)("van-cell-group");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)((0,d.SU)(ne)),(0,o.Wm)(s,{title:"打卡记录",inset:""},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{"min-date":t.value,"max-date":n.value,"row-height":"50",poppable:!1,formatter:a,"show-title":!1,"show-confirm":!1,onSelect:l,style:{height:"344px"}},{"bottom-info":(0,o.w5)((()=>[])),_:1},8,["min-date","max-date"])])),_:1})],64)}}};const de=(0,u.Z)(ce,[["__scopeId","data-v-372ebce5"]]);var me=de,pe=n(5974);const ve=e=>((0,o.dD)("data-v-0cb51cde"),e=e(),(0,o.Cn)(),e),fe={class:"button-group"},ge=(0,o.Uk)("分享 "),he=(0,o.Uk)("清空"),we=(0,o.Uk)("发送 "),_e={style:{width:"100%",margin:"25px 0","text-align":"center"}},ye={style:{"margin-bottom":"5px",color:"#323233"}},be=["src"],We=ve((()=>(0,o._)("p",{style:{"font-size":"14px","margin-top":"0",color:"#646566"}},"扫描上方二维码，控制我的音箱",-1)));var xe={__name:"tts-xiaoxi",setup(e){const t=(0,d.iH)(""),n=(0,d.iH)(!1),a=(0,d.iH)(""),l=(0,d.iH)(6),u=(0,d.iH)(!1),i=(0,d.iH)(!1),s=(0,d.iH)(!1),r=(0,d.iH)(""),c=(0,pe.y)(r);function m(){a.value=""}function p(){b({url:"/tts/getVolume"}).then((e=>{const t=JSON.parse(e.data.info);l.value=t.volume}))}function f(e){e>60?(0,v.g)({type:"warning",message:"声音太大有扰民风险"}):v.g.clear()}function g(){_()}function h(e){b({url:"/tts/setVolume",method:"get",params:{volume:e}}).then((()=>{p()}))}function w(){i.value=!0,b({url:"/tts/say",method:"post",data:{text:a.value}}).then((()=>{m()})).finally((()=>{i.value=!1}))}function _(){s.value=!0,b({url:"/tts/share",method:"get"}).then((e=>{r.value=`https://shanyexia.top/xiaomi-tts-vue/#/praise?token=${e.token}&name=${t.value}`,u.value=!0})).finally((()=>{s.value=!1}))}return(0,o.bv)((()=>{p()})),(e,r)=>{const p=(0,o.up)("van-field"),v=(0,o.up)("van-button"),_=(0,o.up)("van-col"),y=(0,o.up)("van-row"),b=(0,o.up)("van-cell-group"),W=(0,o.up)("van-slider"),x=(0,o.up)("van-dialog");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)((0,d.SU)(ne)),(0,o.Wm)(b,{title:"留言板",inset:""},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=e=>a.value=e),rows:"5",type:"textarea",maxlength:"50",placeholder:"请输入留言内容","show-word-limit":""},null,8,["modelValue"]),(0,o._)("div",fe,[(0,o.Wm)(y,{justify:"space-around"},{default:(0,o.w5)((()=>[(0,o.Wm)(_,{span:"6"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"button",type:"success",size:"small",round:"",onClick:r[1]||(r[1]=e=>n.value=!0),"loading-text":"分享",loading:s.value},{default:(0,o.w5)((()=>[ge])),_:1},8,["loading"])])),_:1}),(0,o.Wm)(_,{span:"6"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"button",type:"warning",size:"small",round:"",onClick:m},{default:(0,o.w5)((()=>[he])),_:1})])),_:1}),(0,o.Wm)(_,{span:"6"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{class:"button",type:"primary",size:"small",round:"",onClick:w,"loading-text":"发送",loading:i.value},{default:(0,o.w5)((()=>[we])),_:1},8,["loading"])])),_:1})])),_:1})])])),_:1}),(0,o.Wm)(b,{title:"音量："+l.value+"%",inset:"",style:{padding:"20px 32px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(W,{modelValue:l.value,"onUpdate:modelValue":[r[2]||(r[2]=e=>l.value=e),f],onChange:h},null,8,["modelValue"])])),_:1},8,["title"]),(0,o.Wm)(x,{show:n.value,"onUpdate:show":r[4]||(r[4]=e=>n.value=e),"show-cancel-button":"",onConfirm:g},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{style:{padding:"20px"},modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=e=>t.value=e),maxlength:"10",placeholder:"请输入临时昵称"},null,8,["modelValue"])])),_:1},8,["show"]),(0,o.Wm)(x,{show:u.value,"onUpdate:show":r[5]||(r[5]=e=>u.value=e),showConfirmButton:!1,closeOnClickOverlay:!0},{default:(0,o.w5)((()=>[(0,o._)("div",_e,[(0,o._)("h3",ye,(0,z.zw)(t.value),1),(0,o._)("img",{style:{width:"80%"},src:(0,d.SU)(c),alt:"qrcode"},null,8,be),We])])),_:1},8,["show"])],64)}}};const ke=(0,u.Z)(xe,[["__scopeId","data-v-0cb51cde"]]);var Ve=ke;const Ue=[{path:"/",redirect:"/layout"},{path:"/login",component:O},{path:"/no-device",component:I},{path:"/praise",component:N},{path:"/layout",component:X,redirect:"/layout/index",children:[{path:"index",component:le},{path:"wode",component:re},{path:"xiaoxi",component:Ve},{path:"daka",component:me}]}],He=(0,c.p7)({history:(0,c.r5)("/xiaomi-tts-vue/"),routes:Ue}),Ce=["/login","/no-device","/praise"];He.beforeEach(((e,t,n)=>{h()||-1!==Ce.indexOf(e.path)?n():(n(`/login?redirect=${e.fullPath}`),(0,v.g)("token不存在"))}));var De=He,Oe=(0,W.MT)({state:{devices:[]},getters:{},mutations:{SET_DEVICES(e,t){e.devices=t.devices}},actions:{setDevices(e){b({url:"/tts/getDevice"}).then((t=>{for(const e of t.data)e.text=e.alias,e.value=e.deviceID;e.commit("SET_DEVICES",{devices:t.data})}))}},modules:{}}),Se=n(1172);n(5110);const je=(0,a.ri)(r);je.use(Se.ZP),je.use(Oe).use(De).mount("#app")}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var l=t[a]={exports:{}};return e[a](l,l.exports,n),l.exports}n.m=e,function(){var e=[];n.O=function(t,a,o,l){if(!a){var u=1/0;for(c=0;c<e.length;c++){a=e[c][0],o=e[c][1],l=e[c][2];for(var i=!0,s=0;s<a.length;s++)(!1&l||u>=l)&&Object.keys(n.O).every((function(e){return n.O[e](a[s])}))?a.splice(s--,1):(i=!1,l<u&&(u=l));if(i){e.splice(c--,1);var r=o();void 0!==r&&(t=r)}}return t}l=l||0;for(var c=e.length;c>0&&e[c-1][2]>l;c--)e[c]=e[c-1];e[c]=[a,o,l]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,l,u=a[0],i=a[1],s=a[2],r=0;if(u.some((function(t){return 0!==e[t]}))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(s)var c=s(n)}for(t&&t(a);r<u.length;r++)l=u[r],n.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return n.O(c)},a=self["webpackChunkxiaomi_tts_vue"]=self["webpackChunkxiaomi_tts_vue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(799)}));a=n.O(a)})();
//# sourceMappingURL=app.35e5a7d4.js.map